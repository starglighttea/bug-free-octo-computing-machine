<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>capybara clicker</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: 'Press Start 2P', cursive;
    text-align: center;
    background: linear-gradient(-45deg, #79c267, #5dbb63, #4fae57, #6dd16a);
    background-size: 400% 400%;
    animation: gradient 15s ease infinite;
    overflow-x: hidden;
}

@keyframes gradient {
    0% {background-position:0% 50%}
    50% {background-position:100% 50%}
    100% {background-position:0% 50%}
}

h1 { margin-top:20px; font-size:18px; }
#score { margin:15px; font-size:12px; }

#capy {
    width:220px;
    cursor:pointer;
    image-rendering:pixelated;
    transition: transform 0.1s;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.4));
}

.goldenGlow {
    animation: goldenPulse 0.6s infinite alternate;
}

@keyframes goldenPulse {
    from { filter: drop-shadow(0 0 5px gold); }
    to { filter: drop-shadow(0 0 25px gold); }
}

.panel {
    background:#f5deb3;
    border:4px solid #5a3d25;
    border-radius:8px;
    padding:12px;
    margin:15px auto;
    width:340px;
    box-shadow:0 8px 0 #3b2616;
}

button {
    width:100%;
    padding:10px;
    margin-top:6px;
    font-family:inherit;
    font-size:9px;
    background:#b97a56;
    border:3px solid #3b2616;
    cursor:pointer;
}

button:hover { background:#8c5a3c; transform:translateY(-2px); }
button:disabled { background:#777; }
.selected { background:#5fa8ff !important; box-shadow:0 0 10px #5fa8ff; }

.popup {
    position:absolute;
    color:white;
    font-size:10px;
    pointer-events:none;
    animation:floatUp 0.8s forwards;
}

@keyframes floatUp {
    from {opacity:1; transform:translateY(0);}
    to {opacity:0; transform:translateY(-40px);}
}
</style>
</head>
<body>

<h1>capybara clicker</h1>
<div id="score"></div>

<img id="capy">

<div class="panel">
<h3>Skins</h3>
<div id="skins"></div>
</div>

<div class="panel">
<h3>Skill Tree</h3>
<div id="skills"></div>
</div>

<script>
let score = 0;
let baseClick = 1;
let autoClick = 0;
let skillPoints = 0;
let levelsUnlocked = 0;
let currentSkin = "classic";
let goldenActive = false;

const skins = {
    classic: {
        cost:0, bonus:1, owned:true,
        frames:["https://i.imgur.com/4AiXzf8.png"],
        speed:500,
        clickScale:0.9
    },
    golden: {
        cost:500, bonus:2, owned:false,
        frames:["https://i.imgur.com/Z6X7K9C.png"],
        speed:300,
        clickScale:0.85
    }
};

const capy = document.getElementById("capy");

let frameIndex=0;
let animInterval;

function startAnimation(){
    clearInterval(animInterval);
    animInterval=setInterval(()=>{
        const frames=skins[currentSkin].frames;
        frameIndex=(frameIndex+1)%frames.length;
        capy.src=frames[frameIndex];
    },skins[currentSkin].speed);
}

function spawnGolden(){
    if(goldenActive) return;
    if(Math.random()<0.05){
        goldenActive=true;
        capy.classList.add("goldenGlow");
        capy.src="https://i.imgur.com/Z6X7K9C.png";

        setTimeout(()=>{
            goldenActive=false;
            capy.classList.remove("goldenGlow");
            startAnimation();
        },6000);
    }
}

setInterval(spawnGolden,15000);

capy.onclick=(event)=>{
    let multiplier=goldenActive?25:1;
    let gain=baseClick*skins[currentSkin].bonus*multiplier;
    score+=gain;

    capy.style.transform="scale("+skins[currentSkin].clickScale+")";
    setTimeout(()=>capy.style.transform="scale(1)",100);

    createPopup(event.pageX,event.pageY,gain);
    checkLevel();
    update();
};

function createPopup(x,y,value){
    let popup=document.createElement("div");
    popup.className="popup";
    popup.innerText="+"+value;
    popup.style.left=x+"px";
    popup.style.top=y+"px";
    document.body.appendChild(popup);
    setTimeout(()=>popup.remove(),800);
}

function checkLevel(){
    let newLevel=Math.floor(score/1000);
    if(newLevel>levelsUnlocked){
        skillPoints+=(newLevel-levelsUnlocked);
        levelsUnlocked=newLevel;
    }
}

function renderSkins(){
    const container=document.getElementById("skins");
    container.innerHTML="";
    for(let key in skins){
        const s=skins[key];
        const btn=document.createElement("button");
        btn.innerHTML=key.toUpperCase()+"<br><span class='small'>"+
        (s.owned?"Owned":"Cost: "+s.cost)+"</span>";
        if(currentSkin===key)btn.classList.add("selected");

        btn.onclick=()=>{
            if(!s.owned&&score>=s.cost){
                score-=s.cost;
                s.owned=true;
            }
            if(s.owned){
                currentSkin=key;
                frameIndex=0;
                startAnimation();
            }
            update();
        };
        container.appendChild(btn);
    }
}

function update(){
    document.getElementById("score").innerText=
        "Capybaras: "+Math.floor(score)+" | SP: "+skillPoints;
    renderSkins();
    save();
}

function save(){
    localStorage.setItem("capySave",JSON.stringify({
        score,baseClick,autoClick,skillPoints,
        levelsUnlocked,currentSkin,skins
    }));
}

function load(){
    const data=JSON.parse(localStorage.getItem("capySave"));
    if(!data)return;
    Object.assign(window,data);
}

setInterval(()=>{
    score+=autoClick;
    checkLevel();
    update();
},1000);

load();
startAnimation();
update();
</script>

</body>
</html>
